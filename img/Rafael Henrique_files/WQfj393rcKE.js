if (self.CavalryLogger) { CavalryLogger.start_js(["yb9JF"]); }

__d('ServiceWorkerExperimentPerfTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],(function a(b,c,d,e,f,g){'use strict';function h(){this.clear();}h.prototype.log=function(){c('GeneratedLoggerUtils').log('logger:ServiceWorkerExperimentPerfLoggerConfig',this.$ServiceWorkerExperimentPerfTypedLogger1,c('Banzai').BASIC);};h.prototype.logVital=function(){c('GeneratedLoggerUtils').log('logger:ServiceWorkerExperimentPerfLoggerConfig',this.$ServiceWorkerExperimentPerfTypedLogger1,c('Banzai').VITAL);};h.prototype.clear=function(){this.$ServiceWorkerExperimentPerfTypedLogger1={};return this;};h.prototype.updateData=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1=babelHelpers['extends']({},this.$ServiceWorkerExperimentPerfTypedLogger1,j);return this;};h.prototype.setAppCache=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.app_cache=j;return this;};h.prototype.setBodyVisible=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.body_visible=j;return this;};h.prototype.setCsstart=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.csstart=j;return this;};h.prototype.setDisplayDone=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.display_done=j;return this;};h.prototype.setDns=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.dns=j;return this;};h.prototype.setDomComplete=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.dom_complete=j;return this;};h.prototype.setDomContentLoad=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.dom_content_load=j;return this;};h.prototype.setDomInteractiveLoad=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.dom_interactive_load=j;return this;};h.prototype.setDomSetup=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.dom_setup=j;return this;};h.prototype.setE2e=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.e2e=j;return this;};h.prototype.setExperimentType=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.experiment_type=j;return this;};h.prototype.setFetchStartMs=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.fetch_start_ms=j;return this;};h.prototype.setFirstResponse=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.first_response=j;return this;};h.prototype.setHardwareConcurrency=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.hardware_concurrency=j;return this;};h.prototype.setIsSecondLoad=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.is_second_load=j;return this;};h.prototype.setIsSwFnrLoad=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.is_sw_fnr_load=j;return this;};h.prototype.setLastResponse=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.last_response=j;return this;};h.prototype.setLoadedViaSwCache=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.loaded_via_sw_cache=j;return this;};h.prototype.setNavStartMs=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.nav_start_ms=j;return this;};h.prototype.setPageClient=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.page_client=j;return this;};h.prototype.setPath=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.path=j;return this;};h.prototype.setRbbDisplayDone=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.rbb_display_done=j;return this;};h.prototype.setRedirect=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.redirect=j;return this;};h.prototype.setRequest=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.request=j;return this;};h.prototype.setRespond=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.respond=j;return this;};h.prototype.setSubstream0=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.substream_0=j;return this;};h.prototype.setSubstream1=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.substream_1=j;return this;};h.prototype.setSwControlledWindow=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.sw_controlled_window=j;return this;};h.prototype.setSwPageLoadCount=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.sw_page_load_count=j;return this;};h.prototype.setSwStarted=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.sw_started=j;return this;};h.prototype.setTcp=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.tcp=j;return this;};h.prototype.setTti=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.tti=j;return this;};h.prototype.setUnload=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.unload=j;return this;};h.prototype.setVC=function(j){this.$ServiceWorkerExperimentPerfTypedLogger1.vc=j;return this;};var i={app_cache:true,body_visible:true,csstart:true,display_done:true,dns:true,dom_complete:true,dom_content_load:true,dom_interactive_load:true,dom_setup:true,e2e:true,experiment_type:true,fetch_start_ms:true,first_response:true,hardware_concurrency:true,is_second_load:true,is_sw_fnr_load:true,last_response:true,loaded_via_sw_cache:true,nav_start_ms:true,page_client:true,path:true,rbb_display_done:true,redirect:true,request:true,respond:true,substream_0:true,substream_1:true,sw_controlled_window:true,sw_page_load_count:true,sw_started:true,tcp:true,tti:true,unload:true,vc:true};f.exports=h;}),null);
__d('ServiceWorkerProfilerTypes',['Map','TimingAnnotations'],(function a(b,c,d,e,f,g){var h={START:'start',PARSED:'parsed',INITIALIZED:'init',FIRST_EVENT:'firstEvent'},i={FETCH_START:'start',ROUTE_CONFIG_CACHE_LOOKUP_START:'routeLookupStart',ROUTE_CONFIG_CACHE_LOOKUP_END:'routeLookupEnd',BEGIN_RESPONSE:'beginResponse',CACHE_FLUSH:'cacheFlush',NETWORK_REQUEST_START:'requestStart',NETWORK_RESPONSE_START:'responseStart',NETWORK_RESPONSE_END:'responseEnd',FETCH_END:'end'};f.exports={WorkerTiming:h,FetchTiming:i};}),null);
__d('ServiceWorkerURLCleaner',[],(function a(b,c,d,e,f,g){var h=/sw_fnr_id=\d+&?/,i=false,j=false,k={removeRedirectID:function l(){if(i)return j;i=true;if(location.search&&h.test(location.search)){j=true;if(history!==undefined&&typeof history.replaceState==='function'){var m=location.toString().replace(h,'').replace(/\?$/,'');history.replaceState({},document.title,m);}}return j;}};f.exports=k;}),null);
__d('ReactBlueBarPerfLogger',['regeneratorRuntime','Arbiter','ArtillerySWDataCollector','BanzaiScuba','BigPipe','ClientChromeExperimentsData','LogBuffer','NavigationMetrics','PageletEventConstsJS','ServiceWorkerExperimentPerfTypedLogger','ServiceWorkerProfilerTypes','ServiceWorkerURLCleaner','SubscriptionsHandler','pageLoadedViaSWCache','performance'],(function a(b,c,d,e,f,g){var h='reactbluebar_perf',i='navigationStart',j='fetchStart',k='domainLookupStart',l='connectStart',m='connectEnd',n='responseStart',o='responseEnd',p='domLoading',q='domInteractive',r='domContentLoadedEventEnd',s='domComplete',t='unloadEventStart',u='unloadEventEnd',v=c('ServiceWorkerProfilerTypes').WorkerTiming,w=c('ServiceWorkerProfilerTypes').FetchTiming,x={},y=function aa(ba){var ca,da=this,ea,fa,ga,ha,ia;return c('regeneratorRuntime').async(function ja(ka){while(1)switch(ka.prev=ka.next){case 0:ea=new (c('BanzaiScuba'))(h,null,{addBrowserFields:true,addGeoFields:true,addPredictedGeographyFields:true,addRequestFields:true});fa=new (c('ServiceWorkerExperimentPerfTypedLogger'))();fa.setExperimentType(ba.experimentName);fa.setIsSecondLoad(ba.isSecondLoad);fa.setLoadedViaSwCache(c('pageLoadedViaSWCache')());fa.setPageClient(ba.page);ea.addNormal('path',b.location.href);fa.setPath(b.location.href);ga=c('ServiceWorkerURLCleaner').removeRedirectID();fa.setIsSwFnrLoad(ga);ea.addInteger('sw_fnr_load',ga?1:0);ea.addNormal('experiment_type',ba.experimentName);ea.addNormal('page_client',ba.page);ea.addNormal('response_type',c('pageLoadedViaSWCache')()?'sw':'server');ea.addNormal('second_load',ba.isSecondLoad);ha=navigator.serviceWorker&&navigator.serviceWorker.controller;fa.setSwControlledWindow(ha);ea.addNormal('sw_controlled_window',ha?1:0);ia={};if(c('ClientChromeExperimentsData').shouldShowClientChrome)ia.client_chrome=1;ea.addTagset('gk_on',ia);if(navigator.hardwareConcurrency){ea.addInteger('hardwareConcurrency',navigator.hardwareConcurrency);fa.setHardwareConcurrency(navigator.hardwareConcurrency);}if(!c('performance').timing){ka.next=25;break;}ka.next=25;return c('regeneratorRuntime').awrap(function la(){var ma,na,oa,pa,qa,ra,sa;return c('regeneratorRuntime').async(function ta(ua){while(1)switch(ua.prev=ua.next){case 0:na=c('performance').timing;oa=na.navigationStart;pa=na.fetchStart;fa.setFetchStartMs(pa);fa.setNavStartMs(oa);ea.addInteger('tti',ba.tti-pa);ea.addInteger('e2e',ba.e2e-pa);ea.addInteger('display_done',ba.displayDone-pa);if(ba.rbbDisplayDone)ea.addInteger('rbb_display_done',ba.rbbDisplayDone-pa);if(ba.bodyVisible)ea.addInteger('body_visible',ba.bodyVisible-pa);if(typeof b._cstart==='number')ea.addInteger('cstart',b._cstart-pa);ua.next=13;return c('regeneratorRuntime').awrap(c('ArtillerySWDataCollector').collect());case 13:qa=ua.sent;if(qa)(function(){var va=qa.workerPerf.workerTimings,wa=qa.workerPerf.fetchTimings,xa=qa.workerPerf.annotations,ya={await_route_config_cache:[w.ROUTE_CONFIG_CACHE_LOOKUP_START,w.ROUTE_CONFIG_CACHE_LOOKUP_END],flush_cache_content:[w.BEGIN_RESPONSE,w.CACHE_FLUSH],await_server_response:[w.CACHE_FLUSH,w.NETWORK_RESPONSE_START],flush_server_content:[w.NETWORK_RESPONSE_START,w.NETWORK_RESPONSE_END]};Object.keys(ya).forEach(function(bb){var cb=ya[bb],db=wa[cb[0]],eb=wa[cb[1]];if(!db||!eb)return;ea.addInteger(bb+'.begin',db.ts-oa);ea.addInteger(bb+'.end',eb.ts-oa);ea.addInteger(bb+'.total',eb.ts-db.ts);});var za=va[v.START];if(za&&za.ts>=oa){ea.addInteger('sw_started',1);fa.setSwStarted(true);}else if(za){ea.addInteger('sw_started',0);fa.setSwStarted(false);}var ab=Number(xa.stringProps.pagesLoadViaSWCount);if(!isNaN(ab)){ea.addInteger('sw_page_load_count',ab);fa.setSwPageLoadCount(ab);}})();ea.addInteger('tti_navs',ba.tti-oa);fa.setTti(ba.tti-oa);ea.addInteger('e2e_navs',ba.e2e-oa);fa.setE2e(ba.e2e-oa);ea.addInteger('display_done_navs',ba.displayDone-oa);fa.setDisplayDone(ba.displayDone-oa);if(ba.rbbDisplayDone){ra=ba.rbbDisplayDone;ea.addInteger('rbb_display_done_navs',ra-oa);fa.setRbbDisplayDone(ra-oa);}if(ba.bodyVisible){sa=ba.bodyVisible;ea.addInteger('body_visible_navs',sa-oa);fa.setBodyVisible(sa-oa);}if(typeof b._cstart==='number'){ea.addInteger('cstart_navs',b._cstart-oa);fa.setCsstart(b._cstart-oa);}Object.keys(x).forEach(function(va){ea.addInteger('pagelet_arrive_'+va+'_navs',x[va]-oa);if(va==='first_response'||va==='last_response'||va==='substream_0'||va==='substream_1'){var wa={};wa[va]=x[va]-oa;fa.updateData(wa);}});[{name:'redirect',start:i,end:j},{name:'app_cache',start:j,end:k},{name:'dns',start:k,end:l},{name:'tcp',start:l,end:m},{name:'request',start:m,end:n},{name:'respond',start:n,end:o},{name:'dom_setup',start:n,end:p},{name:'dom_interactive_load',start:p,end:q},{name:'dom_content_load',start:q,end:r},{name:'dom_complete',start:r,end:s},{name:'unload',start:t,end:u}].forEach(function(va){var wa=va.name,xa=va.start,ya=va.end,za=c('performance').timing[xa]||0,ab=c('performance').timing[ya]||0;if(ab>=za){ea.addInteger('perf_timing_'+wa,ab-za);var bb={};bb[wa]=ab-za;fa.updateData(bb);}});case 26:case 'end':return ua.stop();}},null,da);}());case 25:ea.post();fa.log();case 27:case 'end':return ka.stop();}},null,this);},z={init:function aa(ba){var ca=ba.isSecondLoad,da=ba.experimentName,ea=ba.waitForRBB,fa=null,ga=new (c('SubscriptionsHandler'))();ga.addSubscriptions(c('Arbiter').subscribe('sw/bodyVisible',function(ha,ia){var ja=ia.relativeTime;if(c('performance').timing)fa=ja+c('performance').timing.navigationStart;}));ga.addSubscriptions(c('Arbiter').subscribe(c('BigPipe').Events.init,function(ha,ia){var ja=ia.arbiter,ka=ja.subscribe('pagelet_event',function(la,ma){var event=ma.event,na=ma.id,oa=ma.ts;if(event!==c('PageletEventConstsJS').ARRIVE_START||typeof oa!=='number')return;var pa=['first_response','last_response','pagelet_welcome_box','pagelet_dock','pagelet_navigation','pagelet_composer','substream_0','substream_1','pagelet_ego_pane','async_data_preloader_ReactBlueBarJewelsDataPreloader',{regex:/^topnews_main_stream_(\d+)$/,name:'topnews_main_stream'},{regex:/^hyperfeed_story_id_(\d+)$/,name:'hyperfeed_story'}],qa=null;for(var ra=pa,sa=Array.isArray(ra),ta=0,ra=sa?ra:ra[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var ua;if(sa){if(ta>=ra.length)break;ua=ra[ta++];}else{ta=ra.next();if(ta.done)break;ua=ta.value;}var va=ua;if(typeof va==='string'){if(va===na){qa=va;break;}}else if(va.regex.test(na)){qa=va.name;break;}}if(qa&&!x[qa])x[qa]=oa;});ga.addSubscriptions(ka);}));ga.addSubscriptions(c('NavigationMetrics').addRetroactiveListener(c('NavigationMetrics').Events.NAVIGATION_DONE,function(ha,ia){var ja=ia.page,ka=ia.pageType,la=ia.tti,ma=ia.e2e,na=ia.all_pagelets_displayed;ka=ka||'normal';if(ka!=='normal')return;ga.release();var oa=function pa(qa){var ra=qa.displayDone;y({bodyVisible:fa,rbbDisplayDone:ra,displayDone:na,e2e:ma,page:ja,pageType:ka,tti:la,isSecondLoad:ca,experimentName:da});};if(ea){c('LogBuffer').tail('reactbluebar_perf',oa);}else oa({displayDone:null});}));}};f.exports=z;}),null);